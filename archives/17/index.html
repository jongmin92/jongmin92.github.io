<!doctype html>
<html lang="ko"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><title>92Hz</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="92Hz"><meta name="msapplication-TileImage" content="/img/favicon.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="92Hz"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta property="og:type" content="website"><meta property="og:title" content="92Hz"><meta property="og:url" content="https://jongmin92.github.io/"><meta property="og:site_name" content="92Hz"><meta property="og:locale" content="ko_KR"><meta property="og:image" content="https://jongmin92.github.io/img/og_image.png"><meta property="article:author" content="KimJongMin"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://jongmin92.github.io"},"headline":"92Hz","image":["https://jongmin92.github.io/img/og_image.png"],"author":{"@type":"Person","name":"KimJongMin"},"description":""}</script><link rel="alternate" href="/rss2.xml" title="92Hz" type="application/atom+xml"><link rel="icon" href="/img/favicon.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=UA-90389042-1" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'UA-90389042-1');</script><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><meta name="generator" content="Hexo 5.4.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.png" alt="92Hz" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="external nofollow noopener noreferrer" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item search" title="검색" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time datetime="2017-06-05T15:00:00.000Z" title="6/6/2017, 12:00:00 AM">2017-06-06</time>&nbsp;게시 됨</span><span class="level-item"><time datetime="2021-03-21T11:05:10.781Z" title="3/21/2021, 8:05:10 PM">2021-03-21</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/Programming/">Programming</a><span> / </span><a class="link-muted" href="/categories/Programming/JavaScript/">JavaScript</a></span><span class="level-item">20분안에 읽기 (약 2995 단어)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2017/06/06/JavaScript/client-side-rendering-vs-server-side-rendering/">[번역] Client-side rendering VS. Server-sde rendering</a></h1><div class="content"><h2 id="Index"><a href="#Index" class="headerlink" title="Index"></a>Index</h2><ol>
<li><a href="#1">성능(Performance)</a></li>
<li><a href="#2">검색 엔진 최적화(SEO)</a></li>
<li><a href="#3">사전 렌더링(Prerendering)</a></li>
<li><a href="#4">더 똑똑해진 크롤러</a></li>
<li><a href="#5">덜 똑똑한 크롤러</a></li>
<li><a href="#6">두 세계의 장점</a></li>
<li><a href="#7">토론</a></li>
</ol>
<hr>
<blockquote>
<p>해당 포스팅은 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://medium.com/@adamzerner/client-side-rendering-vs-server-side-rendering-a32d2cf3bfcc">Adam Zerner - Client-side rendering vs. server-side rendering</a>의 글을 번역하였습니다.</p>
</blockquote>
<p>초기에, 웹 프레임워크들은 서버(Server)에서 렌더링된 뷰를 갖고있었습니다. 현재는 클라이언트(Client)에서도 렌더링된 뷰를 가집니다. 지금부터 각각의 장점과 단점에 대해 알아보겠습니다.</p>
<span id="1">
## 성능(Performance)

<p>**<code>서버 측(Server-side)에서 렌더링</code>**을 할 경우, 새로운 웹 페이지를 보고 싶을 때마다 다음과 같이 새로운 페이지 요청이 필요합니다.</p>
<p><img src="/images/post/2017-06-06/server_side_rendering_1.png" alt="서버 측 렌더링 작동 방식 다이어그램"></p>
<p>이것은 먹고 싶은 것이 있을 때마다 슈퍼마켓에 가는것과 비슷합니다. </p>
<p>그러나 **<code>클라이언트 측(Client-side) 렌더링</code>**을 사용할 경우, 슈퍼마켓에 한 번 방문하고 좀 더 시간을 들여 꽤 오랜 기간동안 먹을 음식을 구매합니다. 그런 다음, 먹고 싶은 것이 있을 때마다 슈퍼마켓에 가지 않고 냉장고에서 찾게됩니다.</p>
<p><img src="/images/post/2017-06-06/client_side_rendering_1.png" alt="클라이언트 측 렌더링 작동 방식 다이어그램"></p>
<p>각 접근법에서는 성능면에서 장점과 단점이 있습니다.</p>
<ul>
<li><strong>클라이언트 측 렌더링</strong>을 사용하면 초기 페이지로드가 느려집니다. 네트워크를 통한 통신이 느리므로 사용자에게 콘텐츠를 표시하기 전에 서버를 두 번 왕복해야합니다. 그러나 그 후에는 이후의 모든 페이지로드가 엄청나게 빠릅니다.</li>
<li><strong>서버 쪽 렌더링</strong>을 사용하면 초기 페이지로드가 크게 느려지지 않습니다. 그렇다고 크게 빠르지는 않을 것입니다. 그리고 이후의 다른 요청도 마찬가지입니다.</li>
</ul>
<p>보다 구체적으로 말하자면, <strong>클라이언트 측 렌더링</strong>을 사용하면 <strong>초기 페이지</strong>는 다음과 같이 보입니다.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;client-side-framework.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;app.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>app.js</strong>는 JavaScript의 모든 HTML 페이지를 다음과 같이 문자열로 유지합니다. </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> pages = &#123;</span><br><span class="line">  <span class="string">&#x27;/&#x27;</span>: <span class="string">&#x27;&lt;html&gt; ... &lt;/html&gt;&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;/foo&#x27;</span>: <span class="string">&#x27;&lt;html&gt; ... &lt;/html&gt;&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;/bar&#x27;</span>: <span class="string">&#x27;&lt;html&gt; ... &lt;/html&gt;&#x27;</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>그런 다음 페이지가 로드되면 프레임워크는 URL 표시줄을 보고 [ ‘/‘] 페이지에서 문자열을 가져 와서 <code>div class = &quot;container&quot;&gt; &lt;/ div&gt;</code>에 삽입합니다. 또한 링크를 클릭하면 프레임워크가 이벤트를 가로 채고 컨테이너에 새 문자열 (예 : 페이지 [ ‘/ foo’])을 삽입하고 브라우저가 정상적으로하는 것처럼 HTTP 요청을 실행하지 못하게 합니다.</p>
<hr>
<span id="2">
## 검색 엔진 최적화(SEO)

<div class="video-container"><iframe src="https://www.youtube.com/embed/BNHR6IQJGZs" frameborder="0" loading="lazy" allowfullscreen></iframe></div>

<p><strong>웹 크롤러</strong>가 <em>reddit.com</em> 을 요청하기 시작했다고 가정해봅시다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> request = <span class="built_in">require</span>(<span class="string">&#x27;request&#x27;</span>);</span><br><span class="line">request.get(<span class="string">&#x27;reddit.com&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">error, response, body</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// body looks something like this:</span></span><br><span class="line">  <span class="comment">// &lt;html&gt;</span></span><br><span class="line">  <span class="comment">//   &lt;head&gt; ... &lt;/head&gt;</span></span><br><span class="line">  <span class="comment">//   &lt;body&gt;</span></span><br><span class="line">  <span class="comment">//     &lt;a href=&quot;espn.com&quot;&gt;ESPN&lt;/a&gt;</span></span><br><span class="line">  <span class="comment">//     &lt;a href=&quot;news.ycombinator.com&quot;&gt;Hacker News&lt;/a&gt;</span></span><br><span class="line">  <span class="comment">//     ... other &lt;a&gt; tags ...</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>그러면 크롤러는 응답 본문에있는 <code>&lt;a href&gt;</code> 항목을 사용해서 새 요청을 생성합니다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> request = <span class="built_in">require</span>(<span class="string">&#x27;request&#x27;</span>);</span><br><span class="line">request.get(<span class="string">&#x27;reddit.com&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">error, response, body</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// body looks something like this:</span></span><br><span class="line">  <span class="comment">// &lt;html&gt;</span></span><br><span class="line">  <span class="comment">//   &lt;head&gt; ... &lt;/head&gt;</span></span><br><span class="line">  <span class="comment">//   &lt;body&gt;</span></span><br><span class="line">  <span class="comment">//     &lt;a href=&quot;espn.com&quot;&gt;ESPN&lt;/a&gt;</span></span><br><span class="line">  <span class="comment">//     &lt;a href=&quot;news.ycombinator.com&quot;&gt;Hacker News&lt;/a&gt;</span></span><br><span class="line">  <span class="comment">//     ... other &lt;a&gt; tags ...</span></span><br><span class="line">  </span><br><span class="line">  request.get(<span class="string">&#x27;espn.com&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; ... &#125;);</span><br><span class="line">  request.get(<span class="string">&#x27;news.ycombinator.com&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; ... &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>그 후 크롤러는 <em>espn.com</em> 및 _news.ycombinator.com_의 링크를 사용하여 크롤링을 계속함으로써 프로세스를 계속 진행합니다.</p>
<p>결국 다음과 같은 재귀 코드처럼 동작합니다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> request = <span class="built_in">require</span>(<span class="string">&#x27;request&#x27;</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">crawlUrl</span>(<span class="params">url</span>) </span>&#123;</span><br><span class="line">  request.get(url, <span class="function"><span class="keyword">function</span> (<span class="params">error, response, body</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> linkUrls = getLinkUrls(body);</span><br><span class="line">    linkUrls.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">linkUrl</span>) </span>&#123;</span><br><span class="line">      crawlUrl(linkUrl);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line">crawlUrl(<span class="string">&#x27;reddit.com&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>그렇다면 만약 요청에 의한 응답이 다음과 같은경우는 어떻게 될까요?</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;client-side-framework.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;app.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>위의 코드는 <code>&lt;a href&gt;</code> 태그가 없습니다. 또한 웹 페이지의 내용이 없기 때문에 검색 결과를 표시 할 때 우선순위를 지정하지 않을 것입니다.</p>
<p>크롤러는 거의 알지 못하지만, 클라이언트 측 프레임워크는 멋진 콘텐츠로 <code>&lt;div class = &quot;container&quot;&gt; &lt;/div&gt;&quot;</code>를 채우려합니다.</p>
<p>이러한 이유가 클라이언트 측 렌더링이 SEO에 좋지 않은 이유입니다.</p>
<hr>
<span id="3">
## 사전 렌더링(Prerendering)

<p>2009년에 Google은 이 문제를 해결할 수 있는 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://webmasters.googleblog.com/2009/10/proposal-for-making-ajax-crawlable.html">방법</a>을 소개했습니다.</p>
<p><img src="/images/post/2017-06-06/prerendering.png"></p>
<p>크롤러가 <code>www.example.com/page?query#!mystate</code> 를 방문하면 <code>www.example.com/page?query&amp;_escaped_fragment_=mystate</code> 로 변환됩니다. 이렇게하면 서버가 <code>_escaped_fragment_</code>를 사용하여 요청을 받으면 사람이 아닌 크롤러에서 요청을 받는다는 것을 알 수 있습니다.</p>
<p>그렇기때문에 요청이 크롤러에서 온 경우 <code>&lt;div class = &quot;container&quot;&gt; ... &lt;/ div&gt;</code>를 제공할 수 있습니다.<br>일반적인 요청 인 경우 <code>&lt;div class = &quot;container&quot;&gt; &lt;/ div&gt;</code>를 제공하고 JavaScript가 내용을 내부에 삽입하도록 할 수 있습니다.</p>
<p>그러나 문제가 있습니다. 서버가 <code>&lt;div class = &quot;container&quot;&gt; &lt;/ div&gt;</code>안에 무엇이 들어가는지 알지 못하기 때문입니다. 내부에 무엇이 들어가는지 파악하려면 JavaScript를 실행하고 DOM을 만들고 DOM을 조작해야합니다. 전통적인 웹 서버는 이를 수행하는 방법을 모르기 때문에 <strong>Headless Browser</strong>로 알려진 서비스를 사용합니다.</p>
<p><img src="/images/post/2017-06-06/headless_browser.png"></p>
<hr>
<span id="4">
## 더 똑똑해진 크롤러

<p>6년 후, Google은 크롤러가 한층 더 똑똑해 졌다고 발표했습니다. <strong>Crawler 2.0</strong>에서 <code>&lt;script&gt;</code> 태그를 볼 때 웹 브라우저처럼 실제로 요청을하고 코드를 실행하고 DOM을 조작한다는 것입니다.</p>
<p>그래서 다음과 같은 코드가</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>이제는 이렇게 보이는 것입니다.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">  ...</span><br><span class="line">  ...</span><br><span class="line">  ...</span><br><span class="line">  ...</span><br><span class="line">  ...</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://support.google.com/webmasters/answer/6066468?hl=en">Fetch as Google</a>를 사용하여 Google 크롤러가 특정 URL을 방문했을 때 어떤 내용을 볼지 결정할 수 있습니다.</p>
<p>관련된 발표문의 내용 일부를 첨부합니다.</p>
<blockquote>
<p>당시 우리 시스템은 자바 스크립트를 사용하여 사용자에게 콘텐츠를 제공하는 페이지를 렌더링하고 이해할 수 없었습니다. <a target="_blank" rel="external nofollow noopener noreferrer" href="https://developers.google.com/webmasters/ajax-crawling/docs/learn-more">크롤러는 동적으로 생성 된 콘텐츠를 볼 수 없었기 때문에</a> 웹 마스터가 AJAX 기반 애플리케이션을 검색 엔진으로 인덱싱 할 수 있도록 일련의 방법을 제안했습니다.<br><br>시대가 바뀌 었습니다. 현재 Googlebot이 자바 스크립트 또는 CSS 파일을 크롤링하는 것을 차단하지 않는 한 일반적으로 최신 브라우저와 같이 웹 페이지를 렌더링하고 이해할 수 있습니다.</p>
</blockquote>
<hr>
<span id="5">
## 덜 똑똑한 크롤러

<p>불행히도 Google 만이 유일한 검색 엔진이 아닙니다. Bing, Yahho, Duck Duck Go, Baidu 등도 있으며 실제로 사람들은 이러한 검색 엔진도 빈번하게 사용합니다.</p>
<p><img src="/images/post/2017-06-06/search_engine.png"></p>
<p>다른 검색 엔진은 JavaScript를 잘 처리하지 못합니다. 다음 글을 참고해보세요. <a target="_blank" rel="external nofollow noopener noreferrer" href="https://medium.freecodecamp.com/seo-vs-react-is-it-neccessary-to-render-react-pages-in-the-backend-74ce5015c0c9">SEO vs. React: Web Crawlers are Smarter Than You Think</a></p>
<hr>
<span id="6">
## 두 세계의 장점

<p>두 세계(서버 측 렌더링, 클라이언트 측 렌더링)의 장점을 최대한 활용하려면 다음의 방법이 있습니다.</p>
<ol>
<li>첫 번째 페이지 로드에는 서버 측 렌더링을 사용.</li>
<li>그 후 모든 후속 페이지 로드에는 클라이언트 측 렌더링을 사용.</li>
</ol>
<p><img src="/images/post/2017-06-06/both_worlds.png"></p>
<p>이것이 의미하는 바를 생각해보세요.</p>
<ul>
<li>첫 번째 페이지 로드의 경우 사용자가 콘텐츠를 보기 전에 두 번 왕복하지 않습니다.</li>
<li>후속 페이지 로드가 빨라집니다.</li>
<li>크롤러는 간단한 HTML을 얻습니다. 옛날처럼 JavaScript를 실행하거나 _escaped_fragment_를 처리할 필요가 없습니다.</li>
</ul>
<p>그러나 이를 위한 설정을 하기위해서는 서버에서 약간의 작업이 필요합니다. Angular, React 및 Ember 모두 이 접근 방식으로 변경했습니다.</p>
<hr>
<span id="7">
## 토론

<p>먼저 고려해야 할 몇 가지 사항은 다음과 같습니다.</p>
<ul>
<li>약 2%의 사용자가 JavaScript를 사용할 수 없게 설정되어 있는 경우 클라이언트 측 렌더링이 전혀 작동하지 않습니다.</li>
<li>웹 검색의 약 1/4은 Google 이외의 엔진으로 수행됩니다.</li>
<li>모두가 빠른 인터넷 연결을 사용하는 것은 아닙니다.</li>
<li>휴대 전화 사용자는 대개 빠른 인터넷 연결이 필요하지 않습니다.</li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.nngroup.com/articles/too-fast-ux/">너무 빠른 UI는 혼란 스러울 수 있습니다.</a> 사용자가 링크를 클릭한다고 가정 해보세요. 앱에서 새로운 뷰로 이동합니다. 그러나 새로운 뷰는 이전의 뷰와 미묘하게 다릅니다. 그리고 변경 사항은 즉시 발생했습니다 (클라이언트 측 렌더링의 장점). 새로운 뷰가 실제로 로드 된 것을 사용자가 알지 못할 수도 있습니다. 또는 사용자가 주의를 기울 였지만 상대적으로 미묘하기 때문에 사용자는 전환이 실제로 발생했는지 여부를 감지하기 위해 약간의 노력을 기울여야합니다. 때로는 약간의 로딩 스피너와 전체 페이지 재 렌더링을 하는 것이 좋습니다.</li>
<li>캐싱이 중요합니다. 따라서 서버 측 렌더링을 사용하면 실제로 사용자가 실제로 모든 것을 서버로 가져갈 필요가 없습니다. 때로는 바다 건너편의 “공식”서버가 아닌 근처의 서버에 가면됩니다.</li>
<li>실제로 성과와 관련하여 때로는 중요하지 않습니다. 때로는 속도가 좋고 속도가 약간 올라가더라도 삶이 더 좋아지지는 않습니다.</li>
</ul>
<p>대부분의 사용자는 인터넷 연결 상태가 좋으며 충분히 빠릅니다. 특히 Macbook Pro로 yuppies를 타겟팅하는 경우. 초기로드 시간이 너무 길어서 사용자를 잃을 염려가 없습니다. 사용자가 링크를 클릭 할 때 실제로 새 페이지가 로드된다는 사실을 사용자가 알지 못하는 사용성 문제에 대해 걱정할 필요가 없습니다.</p>
<p>그러나 초기 페이지 로드시 서버 측 렌더링을 사용하는 클라이언트 측 렌더링을위한 사용 사례는 확실합니다. 큰 회사의 경우 #perfMatters, 인터넷 연결 속도가 느린 사용자가 있고 최적화에 충분한 시간을 할애 할 수있는 충분한 엔지니어링 팀이있는 경우가 종종 있습니다.</p>
<p>앞으로 이 같은 형태의 웹 프레임 워크 (초기 페이지 로드시 서버 쪽 렌더링을 사용하고 후에는 클라이언트 측 렌더링을 수행)가 보다 안정되고 사용하기 쉬워지기를 기대합니다. 이 시점에서 추가 된 복잡성은 최소화 될 것입니다. 그러나 오늘날,이 모든 것은 매우 새롭고, 많은 추상화가있을 것으로 기대합니다. 앞으로 더 나아가 클라이언트 측 렌더링이 필요하지 않은 곳에 인터넷 연결이 충분해지기 때문에 추세가 다시 서버 측 렌더링으로 되돌아 갈 것으로 예상됩니다.</p>
</span></span></span></span></span></span></span></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time datetime="2017-05-27T15:00:00.000Z" title="5/28/2017, 12:00:00 AM">2017-05-28</time>&nbsp;게시 됨</span><span class="level-item"><time datetime="2021-03-21T11:03:59.431Z" title="3/21/2021, 8:03:59 PM">2021-03-21</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/Project/">Project</a><span> / </span><a class="link-muted" href="/categories/Project/Emily/">Emily</a></span><span class="level-item">12분안에 읽기 (약 1817 단어)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2017/05/28/Emily/5-aws-lambda/">5) AWS Lambda 사용하기</a></h1><div class="content"><h2 id="Index"><a href="#Index" class="headerlink" title="Index"></a>Index</h2><ol>
<li><a href="#1">AWS Lambda란?</a></li>
<li><a href="#2">CloudWatch와 Lambda 구성하기</a></li>
<li><a href="#3">정리하며</a></li>
</ol>
<hr>
<p><a target="_blank" rel="external nofollow noopener noreferrer" href="http://localhost:4000/2017/05/26/Emily/4-crawling/">저번 포스팅</a>에서 작성한 <strong>학식 메뉴 크롤링(학식 메뉴를 크롤링해 DB에 저장)</strong> 코드를 **<code>AWS Labmda</code>**를 사용해 일주일에 한번씩 실행되도록 스케쥴링을 해보겠습니다.</p>
<blockquote>
<p>AWS(아마존 웹 서비스)에 대한 기본적인 내용은 생략합니다.</p>
</blockquote>
<span id="1">
## AWS Lambda란?

<p>어떠한 이벤트에 따라 Cron 프로세스를 구성하는데에는 다양한 방법이 존재합니다. 서버 인스턴스를 띄워놓고 일정 시간에 이벤트를 발생시키는 것이 일반적인 방법 중 하나이지만 이러한 방법으로 구성할 시에는 해당 시간에 Event를 발생시키는 일을 제외하고는 서버 인스턴스를 낭비하게 됩니다.</p>
<p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://aws.amazon.com/ko/lambda/details/">AWS Lambda</a>는 <strong>이벤트에 응답하여 코드를 실행</strong>하고 자동으로 기본 컴퓨팅 리소스를 관리하는 서버 없는 컴퓨팅 서비스입니다. AWS Lambda를 사용하여 커스텀 로직으로 다른 AWS 서비스를 확장하거나, AWS 규모, 성능 및 보안으로 작동하는 자체 백엔드 서비스를 만들 수 있습니다. AWS Lambda는 Amazon S3 버킷의 객체에 대한 변경 또는 Amazon DynamoDB의 테이블 업데이트와 같은 <strong>다양한 이벤트에 대한 응답으로 코드를 자동 실행</strong>할 수 있습니다.</p>
<p>AWS Lambda는 코드가 실행되지 않을 때는 요금이 부과되지 않습니다. 즉, 서버 인스턴스를 계속 띄워놓는 것과 비교했을 때 더 저렴합니다. AWS Lambda의 자세한 요금 정책은 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://aws.amazon.com/ko/lambda/pricing/">AWS 홈페이지</a>에서 확인 가능합니다. (Lambda 함수가 다른 AWS 서비스를 사용하거나 데이터를 전송하는 경우 추가 요금이 부과될 수 있으므로 필히 확인바랍니다.)</p>
<hr>
<span id="2">
## CloudWatch와 Lambda 구성하기

<ol>
<li>AWS에 로그인 후 Lambda 서비스를 클릭합니다.</li>
</ol>
<p><img src="/images/post/2017-05-28/lambda_1.png" alt="Lambda Function 생성하기 - 1"></p>
<ol start="2">
<li>저와 같이 이미 생성한 Lambda 함수가 있는 경우는 아래와 같이 <strong>Create a Lambda Function</strong> 버튼을 클릭하고 처음으로 Lambda 함수를 생성하는 경우는 <strong>Get Started Now</strong> 버튼을 클릭합니다.</li>
</ol>
<p><img src="/images/post/2017-05-28/lambda_2.png" alt="Lambda Function 생성하기 - 2"></p>
<ol start="3">
<li>Blueprint는 자주 사용되어지는 미리 준비된 Lambda 함수의 환경을 제공합니다. 저희는 <strong>Blank Function</strong>을 선택해서 직접 trigger(Event)와 환경을 설정합니다.</li>
</ol>
<p><img src="/images/post/2017-05-28/lambda_3.png" alt="Lambda Function 생성하기 - 3"></p>
<ol start="4">
<li>Lambda를 일정 시간 규칙에 맞게 호출할 것이기 때문에 <strong>CloudWatch Events - Schedule</strong>를 선택합니다. <a target="_blank" rel="external nofollow noopener noreferrer" href="https://aws.amazon.com/ko/cloudwatch/">CloudWatch</a>는 AWS에서 실행되는 애플리케이션을 위한 모니터링 서비스 뿐만 아니라 Schedule도 제공합니다.<br>(Lambda를 실행시키기 위한 trigger로 다양한 방법이 제공됩니다. 한가지 예시로 S3의 특정 Bucket에 이미지 파일이 업로드 될때마다 ReSizing을 하고싶다면 trigger로 S3를 설정한 후 Bucket과 Event type(Delete, Put, Post, Copy)을 설정하여 해당 Lambda를 수행하도록 할 수 있습니다.)</li>
</ol>
<p><img src="/images/post/2017-05-28/lambda_4.png" alt="Lambda Function 생성하기 - 4"></p>
<ol start="5">
<li>CloudWatch Events -  Schedule의 내용을 작성합니다. <strong>Rule name</strong>과 <strong>Rule description</strong>에는 해당 Schedule의 이름과 설명을 적고, <strong>Schedule expression</strong>에는 Event를 발생시키고자 하는 주기에 맞게 Cron 식을 작성합니다.<br>Schedule expression에 작성한 Cron 식에 따라 Event가 발생하는 시간이 달라집니다. Cron 식을 처음 접하시는 분은 <a target="_blank" rel="external nofollow noopener noreferrer" href="http://docs.aws.amazon.com/ko_kr/AmazonCloudWatch/latest/events/ScheduledEvents.html">AWS 홈페이지1</a>, <a target="_blank" rel="external nofollow noopener noreferrer" href="http://docs.aws.amazon.com/ko_kr/lambda/latest/dg/tutorial-scheduled-events-schedule-expressions.html">AWS 홈페이지2</a>를 참고해서 Cron 식을 작성합니다.</li>
</ol>
<p><strong>단, Cron 식에 사용되는 시간은 UTC를 기준으로 하기 때문에 유의해야 합니다. 제가 작성한 cron 식 <code>(0 13 ? * SUN *)</code>을 기준으로 하면 <code>매주 일요일 22(13+9)시</code>에 이벤트가 발생합니다.</strong></p>
<p><img src="/images/post/2017-05-28/lambda_5.png" alt="Lambda Function 생성하기 - 5"></p>
<p>6-1) 다음과 같이 Lambda function의 <strong>이름, 설명, 실행환경</strong>(포스팅 기준 Node.js 6.10 이 최신 버전입니다.) 을 작성합니다.</p>
<p>6-2) 다음으로 CloudWatch Events에 의해서 실행될 <strong>코드</strong>를 기재해야합니다. 코드를 기재하는 방식은 <strong>직접 작성, .ZIP 파일로 압축, S3를 이용</strong>하는 3가지 방식중 하나로 진행됩니다.<br>만약 작성한 코드가 aws-sdk를 제외한 외부 라이브러리를 사용하고 있다면 <strong>코드와 함께 라이브러리 파일(node_modules)을 압축</strong>하여 .ZIP 파일을 업로드 해야합니다.</p>
<p>6-3) 기존에 작성했던 코드에서 수정이 필요합니다. Lambda function의 코드가 에러없이 잘 완료되었는지 <strong>callback</strong>을 통해 결과를 반환해야합니다. <a target="_blank" rel="external nofollow noopener noreferrer" href="http://localhost:4000/2017/05/26/Emily/4-crawling/">지난번에 작성했던 코드</a>는 다음과 같이 수정됩니다. (예시를 들기위해 간단하게 작성했을 뿐, 실제 DB에 Insert 하는 부분은 생략되어 있습니다.)<br>29, 30번째 줄과, 34번째 줄에 추가된 코드에 주의하셔야 합니다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">exports</span>.handler = <span class="function">(<span class="params">event, context, callback</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> request = <span class="built_in">require</span>(<span class="string">&#x27;request&#x27;</span>);</span><br><span class="line">    <span class="keyword">const</span> cheerio = <span class="built_in">require</span>(<span class="string">&#x27;cheerio&#x27;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">const</span> url = <span class="string">&quot;http://www.inu.ac.kr/com/cop/mainWork/foodList1.do?siteId=inu&amp;id=inu_050110010000&amp;command=week&quot;</span>;</span><br><span class="line">    </span><br><span class="line">    request(url, <span class="function">(<span class="params">error, response, body</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (error) <span class="keyword">throw</span> error;</span><br><span class="line">    </span><br><span class="line">      <span class="keyword">let</span> $ = cheerio.load(body);</span><br><span class="line">    </span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> krDay = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="keyword">let</span> corner = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="keyword">let</span> menu = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    </span><br><span class="line">        $(<span class="string">&#x27;table&#x27;</span>).find(<span class="string">&#x27;tr&#x27;</span>).each(<span class="function"><span class="keyword">function</span> (<span class="params">index, elem</span>) </span>&#123;</span><br><span class="line">          <span class="keyword">if</span> (index % <span class="number">6</span> === <span class="number">0</span>) &#123;</span><br><span class="line">            krDay = $(<span class="built_in">this</span>).find(<span class="string">&#x27;th&#x27;</span>).text().trim();</span><br><span class="line">    </span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;krDay&#125;</span>`</span>);</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            corner = $(<span class="built_in">this</span>).find(<span class="string">&#x27;th&#x27;</span>).text().trim();</span><br><span class="line">            menu = $(<span class="built_in">this</span>).find(<span class="string">&#x27;th&#x27;</span>).next().text().trim();</span><br><span class="line">    </span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;corner&#125;</span> -&gt; <span class="subst">$&#123;menu&#125;</span>`</span>);</span><br><span class="line">          &#125;</span><br><span class="line">          </span><br><span class="line">          callback(<span class="literal">null</span>);</span><br><span class="line">          context.succeed();</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="built_in">console</span>.error(error);</span><br><span class="line">        callback(err);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><img src="/images/post/2017-05-28/lambda_6_1.png" alt="Lambda Function 생성하기 - 6"></p>
<p>6_4) 필요에 따라 환경변수(Environment variables)와 Advanced settings를 작성한 후 <strong>Role</strong>을 작성하고 다음단계로 넘어갑니다. (Handler에 index.handler 라고 작성했기 때문에 .ZIP파일로 압축할때 소스코드(.js)의 파일명은 index가 되어야 합니다)</p>
<p><img src="/images/post/2017-05-28/lambda_6_2.png" alt="Lambda Function 생성하기 - 6"></p>
<ol start="7">
<li>지금까지 설정한 옵션을 확인하고 최종적으로 function을 생성합니다.</li>
</ol>
<p><img src="/images/post/2017-05-28/lambda_7.png" alt="Lambda Function 생성하기 - 7"></p>
<ol start="8">
<li>생성된 Lambda Function을 <strong>테스트</strong>할 수 있습니다. Actions -&gt; Configure test event를 통해 테스트를 위한 이벤트를 설정합니다. trigger(Event)로 CloudWatch Events - Schedule를 설정했기 때문에 event template 목록 중 <strong>Schedule Event</strong>를 선택합니다.</li>
</ol>
<p><img src="/images/post/2017-05-28/lambda_8_1.png" alt="Lambda Function 테스트 - 1"><br><img src="/images/post/2017-05-28/lambda_8_2.png" alt="Lambda Function 테스트 - 2"></p>
<ol start="9">
<li>테스트 후 CloudWatch의 <strong>로그</strong>를 통해서 lambda function 코드에서 출력했던 로그 및 실행결과를 확인할 수 있습니다.</li>
</ol>
<p><img src="/images/post/2017-05-28/lambda_9_1.png" alt="Lambda Function 로그 확인 - 1"><br><img src="/images/post/2017-05-28/lambda_9_2.png" alt="Lambda Function 로그 확인 - 2"></p>
<hr>
<span id="3">
## 정리하며

<p>지금까지 진행한 작업은 다음의 이미지 한장으로 정리가 가능합니다. 이번기회에 lambda를 처음 사용해봤지만 앞으로 개인프로젝트에도 실무에서도 자주 사용하게될 것 같습니다.</p>
<p><img src="/images/post/2017-05-28/cloudwatch_lambda.png" alt="AWS의 CloudWatch와 Lambda"></p>
</span></span></span></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time datetime="2017-05-25T15:00:00.000Z" title="5/26/2017, 12:00:00 AM">2017-05-26</time>&nbsp;게시 됨</span><span class="level-item"><time datetime="2021-03-21T11:03:57.337Z" title="3/21/2021, 8:03:57 PM">2021-03-21</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/Project/">Project</a><span> / </span><a class="link-muted" href="/categories/Project/Emily/">Emily</a></span><span class="level-item">14분안에 읽기 (약 2078 단어)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2017/05/26/Emily/4-crawling/">4) 학식 메뉴 크롤링 하기</a></h1><div class="content"><h2 id="Index"><a href="#Index" class="headerlink" title="Index"></a>Index</h2><ol>
<li><a href="#1">크롤링이란?</a></li>
<li><a href="#2">Scraping - 데이터 가져오기</a></li>
<li><a href="#3">Parsing - 데이터 추출하기</a></li>
<li><a href="#4">크롤링 이후</a></li>
</ol>
<hr>
<p><a target="_blank" rel="external nofollow noopener noreferrer" href="http://plus.kakao.com/home/@%EC%9D%B8%EC%B2%9C%EB%8C%80%ED%95%99%EA%B5%90-%EC%97%90%EB%B0%80%EB%A6%AC">인천대학교-에밀리</a>에 처음 추가한 기능은 <strong>교내 식당의 메뉴를 알려주는 기능</strong>이였습니다. 학교 DB에 접근할 수 있는 권한이 없었기 때문에 <strong>하루마다 매일 갱신</strong>되는 식당의 메뉴를 알기 위해서는 <a target="_blank" rel="external nofollow noopener noreferrer" href="http://www.inu.ac.kr/com/cop/mainWork/foodList1.do?siteId=inu&id=inu_050110010000&command=week">학교 홈페이지</a>에서 데이터를 참조하는 방법밖에 없었습니다. 이를 해결하기 위해 **<code>크롤링</code>**에 대해 공부하고 구현했던 방법에 대해 포스팅하려 합니다.</p>
<blockquote>
<p>Node 버전은 <strong>6.6.0</strong>을 사용합니다.</p>
</blockquote>
<span id="1">
## 크롤링이란?

<p>우리가 흔히 부르는 **크롤링(crawling)**이란 **스크래핑(scraping)**이라고도 합니다. 즉 <strong>웹 페이지를 그대로 가져와 데이터를 추출해 내는 행위</strong>입니다. 크롤링 하는 소프트웨어를 크롤러(crawler)라고 부릅니다.</p>
<p>웹 크롤러(web crawler)는 조직적, 자동화된 방법으로 월드 와이드 웹(WWW)을 탐색하는 프로그램입니다. 검색 엔진과 같은 여러 사이트에서는 데이터의 최신 상태 유지를 위해 웹 크롤링을 합니다. 웹 크롤러는 대체로 방문한 사이트의 모든 페이지 복사본을 생성하는데 사용되며, 검색 엔진은 이렇게 생성된 페이지를 보다 빠른 검색을 위해 인덱싱합니다.</p>
<p>웹 크롤러는 시드(seeds)라고 불리는 URL 리스트에서부터 시작해서 페이지의 모든 하이퍼링크를 인식하여 URL 리스트를 갱신합니다. 갱신된 리스트를 재귀적으로 다시 방문합니다.</p>
<p>결국 <strong>웹 크롤러는 엄청난 분량의 웹문서를 사람이 직접 구별해서 모으는 일은 거의 불가능하기 때문에, 이를 자동으로 수행해 주는 것입니다.</strong></p>
<p>웹은 기본적으로 <strong>HTML</strong> 형태로 되어 있습니다. 아래와 같이 **<code>페이지 소스 보기</code>**를 통해 확인할 수 있습니다.</p>
<p><img src="/images/post/2017-05-26/html_structure.png" alt="페이지 소스 보기로 확인한 HTML 구조"></p>
<p>위와 같은 HTML의 형태를 분석해서 원하는 정보만을 뽑아오는 것을 **<code>웹 크롤링</code>**작업이라고 합니다.</p>
<p>웹 사이트의 데이터를 수집하는데 있어서 2가지 단계만 기억하면 됩니다. 일반적으로는 이 2가지 과정을 합쳐 크롤링이라고 부르지만, 각각의 단계는 명확히 구분됩니다.</p>
<p>1.<strong>Scraping</strong> : 데이터를 어떻게 가져올 것인가?</p>
<p>2.<strong>Parsing</strong> : 가져온 데이터를 어떻게 추출할 것인가?</p>
<hr>
<span id="2">
## Scraping - 데이터 가져오기

<p>Javascript에서 웹 페이지 데이터를 가져오기 위해서 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/request/request">request</a> 모듈을 사용합니다.</p>
<p>먼저 request 모듈을 설치합니다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install request --save</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> request = <span class="built_in">require</span>(<span class="string">&#x27;request&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> url = <span class="string">&quot;http://www.inu.ac.kr/com/cop/mainWork/foodList1.do?siteId=inu&amp;id=inu_050110010000&amp;command=week&quot;</span>;</span><br><span class="line"></span><br><span class="line">request(url, <span class="function">(<span class="params">error, response, body</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (error) <span class="keyword">throw</span> error;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log(body);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>위의 코드를 실행하면 아래와 같이 제가 얻고자 했던 학식 메뉴의 데이터를 포함한 웹 페이지 데이터를 가져옵니다. 해당 데이터는 크롬에서 **<code>보기 - 개발자 정보 - 소스 보기</code>**를 통해서도 확인이 가능합니다.</p>
<p><img src="/images/post/2017-05-26/scraping.png" alt="웹 페이지 Scraping"></p>
<hr>
<span id="3">
## Parsing - 데이터 추출하기

<p>Scraping을 통해 가져온 데이터에서 원하는 데이터만을 추출(Parsing)하기 위해 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/cheeriojs/cheerio">cheerio</a> 모듈을 사용합니다.</p>
<p>cheerio 모듈을 설치합니다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install cheerio --save</span><br></pre></td></tr></table></figure>

<p>cherrio 모듈을 사용하면 웹 클라이언트 자바스크립트 라이브러리인 <strong><code>jQuery</code></strong> 에서 사용하는 것 처럼 style을 통해 element를 선택할 수 있어, 기존의 선택자 방식을 그대로 사용할 수 있습니다.</p>
<p>따라서 cherrio를 사용하기 위해서는 Request 모듈을 통해 가져온 HTML 데이터에서 <strong>어떤 element가 우리가 원하는 데이터를 갖고 있는지 파악할 필요가 있습니다.</strong></p>
<p>웹 페이지의 HTML 구조는 크롬의 **<code>보기 - 개발자 정보 - 개발자 도구</code>**를 통해 확인할 수 있습니다.</p>
<p>학식 메뉴 데이터를 포함하고 있는 table은 다음과 같은 구조를 갖고 있습니다.</p>
<p><img src="/images/post/2017-05-26/html_structure2.png" alt="HTML 구조 - 개발자 도구"></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span> <span class="attr">class</span>=<span class="string">&quot;bdlrNone&quot;</span>&gt;</span>29(월)<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>1코너<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>햄순두부찌개 / 고추장삼겹살볶음 / 훈제오리철판구이 (2인)<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">&quot;bdlrNone&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>2코너<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>등심돈까스&amp;해쉬포테이토 / 떡갈비난자완스덮밥<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">&quot;bdlrNone&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>3코너<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>냉모밀&amp;닭갈비덮밥<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">&quot;bdlrNone&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>4코너<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>삼겹살스테이크,치즈함박스테이크,고르곤졸라피자,치즈오븐스파게티(토마토),빠네파스타,도리아(불닭,불고기),불고기샐러드,닭가슴살샐러드,훈제연어샐러드,옛날통닭<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">&quot;bdlrNone&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>5코너<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>신라면,신라면정식,만두라면,쫄면,해물짬뽕라면,폭탄라면,떡라면,치즈라면,크림치즈김밥,참치김밥,즉석떡볶이,짜파게티,냄비우동<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">&quot;bdlrNone&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">thead</span>&gt;</span>...<span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tbody</span>&gt;</span>...<span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">thead</span>&gt;</span>...<span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tbody</span>&gt;</span>...<span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">thead</span>&gt;</span>...<span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tbody</span>&gt;</span>...<span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">thead</span>&gt;</span>...<span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tbody</span>&gt;</span>...<span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">thead</span>&gt;</span>...<span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tbody</span>&gt;</span>...<span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">thead</span>&gt;</span>...<span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tbody</span>&gt;</span>...<span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>제가 필요한 데이터는 <strong>1. 날짜, 2. 코너, 3. 메뉴</strong> 인데 이 데이터는 다음과 같은 구조로 존재합니다.</p>
<p>table 태그 안에 thead &gt; tr &gt; th 에는 날짜, tbody &gt; tr &gt; th 에는 코너, tbody &gt; tr &gt; td 에는 메뉴가 있습니다.</p>
<p>thead와 tbody 태그를 사용해서 데이터를 추출할 수 있지만 테이블이 규칙적으로 만들어져 있기 때문에 table 태그의 tr 태그만 추출한 후 <strong>규칙을 이용</strong>해서도 쉽게 데이터를 추출 할 수 있습니다.</p>
<p>table에서 하루의 식단은 <strong>6개의 tr 태그마다 반복</strong> 되고 있습니다.<br>1번째 tr 태그는 th 태그 안에 <strong>날짜</strong> 데이터를 갖고 있고,<br>2번째~6번째 tr 태그는 th 태그 안에는 <strong>코너</strong> 데이터를, td 태그 안에는 <strong>메뉴</strong> 데이터를 갖고 있습니다.</p>
<p>이를 이용해 다음과 같이 코드를 작성할 수 있습니다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> request = <span class="built_in">require</span>(<span class="string">&#x27;request&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> cheerio = <span class="built_in">require</span>(<span class="string">&#x27;cheerio&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> url = <span class="string">&quot;http://www.inu.ac.kr/com/cop/mainWork/foodList1.do?siteId=inu&amp;id=inu_050110010000&amp;command=week&quot;</span>;</span><br><span class="line"></span><br><span class="line">request(url, <span class="function">(<span class="params">error, response, body</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (error) <span class="keyword">throw</span> error;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> $ = cheerio.load(body);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> krDay = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">let</span> corner = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">let</span> menu = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    $(<span class="string">&#x27;table&#x27;</span>).find(<span class="string">&#x27;tr&#x27;</span>).each(<span class="function"><span class="keyword">function</span> (<span class="params">index, elem</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (index % <span class="number">6</span> === <span class="number">0</span>) &#123;</span><br><span class="line">        krDay = $(<span class="built_in">this</span>).find(<span class="string">&#x27;th&#x27;</span>).text().trim();</span><br><span class="line"></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;krDay&#125;</span>`</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        corner = $(<span class="built_in">this</span>).find(<span class="string">&#x27;th&#x27;</span>).text().trim();</span><br><span class="line">        menu = $(<span class="built_in">this</span>).find(<span class="string">&#x27;th&#x27;</span>).next().text().trim();</span><br><span class="line"></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;corner&#125;</span> -&gt; <span class="subst">$&#123;menu&#125;</span>`</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="built_in">console</span>.error(error);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>결과는 다음과 같습니다.</p>
<p><img src="/images/post/2017-05-26/parsing.png" alt="parsing 결과"></p>
<hr>
<span id="4">
## 크롤링 이후

<p>크롤링을 통해 원하는 데이터를 추출했다면 이를 활용해야 합니다. 에밀리에서는 사용자의 요청(학생식당, 카페테리아, 사범대식당, 기숙사식당, 교직원식당)에 따라 해당하는 식당의 메뉴를 제공합니다.</p>
<p>메뉴라는 데이터 특성상 실시간으로 변경되는 데이터가 아니기 때문에 한번 크롤링 하고 나면 사용자의 요청(식당)에 따라 다른 응답해주면 될 뿐 데이터 자체는 요일이 변경되지 않는이상 계속 유효합니다. 따라서 <strong>학교 사이트에서 메뉴를 크롤링하는 행위는 학교 메뉴가 갱신되는 일주일 주기마다 한번씩만 하고 크롤링한 데이터를 DB에 저장한다면 사용자의 요청마다 반복적인 크롤링을 하지 않을 수 있습니다.</strong></p>
<p>이를 위한 해결 방법으로는 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/node-schedule/node-schedule">node-schedule</a> 모듈을 사용해서 정해진 시간마다 실행되도록 하는 방법이 있습니다.</p>
<p>혹은 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://aws.amazon.com/ko/lambda/">AWS-Lambda</a>를 사용할 수도 있습니다.</p>
<p>저는 <strong><code>AWS-Lambda</code></strong> 를 사용해서 스케쥴링을 하였는데 이와 관련된 내용은 다음에 포스팅하도록 하겠습니다.</p>
</span></span></span></span></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time datetime="2017-05-16T15:00:00.000Z" title="5/17/2017, 12:00:00 AM">2017-05-17</time>&nbsp;게시 됨</span><span class="level-item"><time datetime="2021-03-21T11:03:54.997Z" title="3/21/2021, 8:03:54 PM">2021-03-21</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/Project/">Project</a><span> / </span><a class="link-muted" href="/categories/Project/Emily/">Emily</a></span><span class="level-item">15분안에 읽기 (약 2197 단어)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2017/05/17/Emily/3-make-express-project/">3) Express 프로젝트 생성하기</a></h1><div class="content"><h2 id="Index"><a href="#Index" class="headerlink" title="Index"></a>Index</h2><ol>
<li><a href="#1">들어가기 앞서</a></li>
<li><a href="#2">Express 프로젝트 생성하기</a></li>
<li><a href="#3">옐로아이디 API 문서 살펴보기</a></li>
<li><a href="#4">API 작성하기</a></li>
<li><a href="#5">서버 실행 &amp; API 연동하기</a></li>
<li><a href="#6">마치며</a></li>
</ol>
<hr>
<span id="1">
## 들어가기 앞서
**옐로아이디 자동응답API** 를 만드는데에는 여러가지 방법이 있습니다. 저는 **`Express generator`**를 사용하여 생성한 **`Express`** 기반의 프로젝트로 **Emily**를 만들었고 이 방식으로 설명할 예정입니다. 그러나 간단한 기능만 구현하는 경우 AWS의 Lambda와 API GateWay를 사용해서도 Serverless하게 만들 수 있습니다. 해당 내용은 [박상권의 삽질블로그](http://gun0912.tistory.com/63)를 참고하면 좋을것 같습니다.

<hr>
<span id="2">
## Express 프로젝트 생성하기
>Node 버전은 **6.6.0**을 사용합니다. Node가 설치되어 있지 않다면 글을 작성하는 기준으로 LTS 버전인 **6.10.3**이상의 버전을 설치합니다. 이왕이면 nvm을 이용하여 설치하는것을 권장합니다. ([nvm 관련글 참고](https://jongmin92.github.io/2016/09/20/Node/nvm-(Node-Version-Manager))
 npm, Express 에 대해서는 해당 글에서 자세하게 설명하지 않겠습니다. 더 좋은 글들이 많으니 참고하시기 바랍니다!!

<p>이제 Express 프로젝트를 생성하겠습니다.</p>
<p>npm을 통해 **<code>Express generator</code>**를 먼저 설치합니다. (global로 추가하기 위해 -g 옵션을 사용합니다.)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install express-generator -g</span><br></pre></td></tr></table></figure>

<p><strong>Express generator</strong>를 사용해서 프로젝트를 생성합니다. 저는 Emily라는 이름으로 프로젝트를 생성했습니다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ express Emily</span><br></pre></td></tr></table></figure>

<p>생성된 프로젝트 폴더로 이동하여 모듈을 설치합니다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ cd Emily</span><br><span class="line">$ npm install</span><br></pre></td></tr></table></figure>

<p>생성된 프로젝트는 다음과 같은 구조입니다. 이제 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/plusfriend/auto_reply">옐로아이디 API 문서</a>를 참고해서 간단한 봇을 만들어보겠습니다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── app.js</span><br><span class="line">├── bin</span><br><span class="line">│   └── www</span><br><span class="line">├── package.json</span><br><span class="line">├── public</span><br><span class="line">│   ├── images</span><br><span class="line">│   ├── javascripts</span><br><span class="line">│   └── stylesheets</span><br><span class="line">│       └── style.css</span><br><span class="line">├── routes</span><br><span class="line">│   ├── index.js</span><br><span class="line">│   └── users.js</span><br><span class="line">└── views</span><br><span class="line">    ├── error.jade</span><br><span class="line">    ├── index.jade</span><br><span class="line">    └── layout.jade</span><br></pre></td></tr></table></figure>

<hr>
<span id="3">
## API 문서 살펴보기
카카오톡 이용자가 플러스친구, 옐로아이디에게 보낸 메세지를 카카오톡 서버를 통해 저희가 전달 받은 후 다시 카카오톡 서버로 응답 메시지를 전달해야하기 때문에 카카오톡에서 정의하고 있는 API 문서에 맞게 코드를 작성해야 합니다.

<p>지금부터 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/plusfriend/auto_reply">옐로아이디 API 문서</a>를 살펴보겠습니다. 본 포스팅에서는 **[이용에 대한 참고사항, 개인정보 수집 및 이용에 대한 주의사항]**에 대해서는 따로 설명하지 않습니다. 그러나 개발전에 한번쯤은 꼭 읽어보셔야합니다.</p>
<h4 id="1-용어"><a href="#1-용어" class="headerlink" title="1. 용어"></a>1. 용어</h4><p>먼저 API 문서에서 사용되는 용어에 대해서 살펴보겠습니다.</p>
<p><strong>(1) 수신 API</strong><br>카카오톡 이용자가 플러스친구, 옐로아이디에게 보낸 메시지를 전달 받은 후 응답을 할 수 있는 API 입니다.<br><strong>http(s) restful api를 통하여</strong> 카카오 API 서버 -&gt; 파트너 서버를 호출합니다.</p>
<p><strong>(2) app_key</strong><br>플러스친구/옐로아이디에서 <strong>자동응답을 위한 앱 등록시 프로필별로 발급되는 고유 키 값</strong>입니다.<br>자동응답 기능만 이용하시는 경우 사용되지 않으며, 일부 app_secret을 통한 별도 인증이 필요한 일부 프로필에만 사용됩니다.</p>
<p><strong>(3) app_secret</strong><br>인증을 위해 app_key와 조합하여 사용되는 키 값입니다.<br>자동응답 기능만 이용하시는 경우 사용되지 않으며, 일부 app_secret을 통한 별도 인증이 필요한 일부 프로필에만 사용됩니다.</p>
<p><strong>(4) user_key</strong><br>특정 카카오톡 이용자를 구분하기 위한 key 입니다. 카카오에서는 이용자의 개인정보를 외부에 제공하지 않으므로, 외부 파트너사에서 카카오톡 이용자를 구분하기 위해서는 카카오로부터 API를 통해 user_key를 response로 받아야 합니다.<br><strong>user_key는 특정 카카오톡 이용자에 대해 프로필별로 각기 다르게 발급됩니다. 따라서 user_key는 해당 프로필에 대해서만 유효합니다.<br>카카오톡 이용자가 프로필을 차단했다가 다시 추가한 경우에는 user_key가 갱신되지 않으며, 이용자가 카카오톡 탈퇴 후 재가입한 경우 갱신됩니다.</strong></p>
<h4 id="2-API"><a href="#2-API" class="headerlink" title="2. API"></a>2. API</h4><p>카카오에서 제공하고 있는 옐로아이디 API는 아래와 같이 5개 입니다. 각 API에 대한 자세한 내용은 문서를 참고합니다.</p>
<table class="table">
<thead>
<tr>
<th>Action</th>
<th align="center">Method</th>
<th align="center">URL</th>
<th>설명</th>
</tr>
</thead>
<tbody><tr>
<td>키보드</td>
<td align="center">GET</td>
<td align="center">/keyboard</td>
<td>처음에 사용자가 채팅방에 들어왔을때 호출되는 API. 사용자에게 키보드에 보여질 내용을 리턴</td>
</tr>
<tr>
<td>메시지</td>
<td align="center">POST</td>
<td align="center">/message</td>
<td>사용자가 보내는 메세지/사진/동영상 을 받아 처리해 응답</td>
</tr>
<tr>
<td>친구추가</td>
<td align="center">POST</td>
<td align="center">/friend</td>
<td>사용자가 옐로아이디를 친구추가했을때 호출되는 API</td>
</tr>
<tr>
<td>친구차단(삭제)</td>
<td align="center">DELETE</td>
<td align="center">/friend</td>
<td>사용자가 옐로아이디를 친구차단(삭제)했을때 호출되는 API</td>
</tr>
<tr>
<td>채팅방 나가기(삭제)</td>
<td align="center">DELETE</td>
<td align="center">/chat_room</td>
<td>사용자가 채팅방 나가기(삭제)했을때 호출되는 API</td>
</tr>
</tbody></table>


<hr>
<span id="4">
## API 작성하기
API 문서를 참고하여 코드를 작성하겠습니다. 작성하는 코드는 사용자가 옐로아이디를 친구 추가 후 채팅방에서 입력하는 메시지를 받아 그대로 다시 전달해주는 코드입니다.

<p><strong><code>routes</code></strong> 폴더 아래에 **<code>api.js</code>**를 추가 후 다음 코드를 작성합니다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> router = express.Router();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 처음에 사용자가 채팅방에 들어왔을때 호출되는 API. 사용자에게 키보드에 보여질 내용을 리턴</span></span><br><span class="line">router.get(<span class="string">&#x27;/keyboard&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">  res.status(<span class="number">200</span>).json(</span><br><span class="line">    &#123;</span><br><span class="line">      type: <span class="string">&#x27;text&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  );</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 사용자가 보내는 메세지/사진/동영상 을 받아 처리해 응답</span></span><br><span class="line">router.post(<span class="string">&#x27;/message&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; user_key, type, content &#125; = req.body;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`&quot;<span class="subst">$&#123;user_key&#125;</span>&quot;가 &quot;<span class="subst">$&#123;content&#125;</span>&quot; 메시지 입력`</span>);</span><br><span class="line"></span><br><span class="line">  res.status(<span class="number">200</span>).json(&#123;</span><br><span class="line">    message: &#123;</span><br><span class="line">      content</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 사용자가 옐로아이디를 친구추가했을때 호출되는 API</span></span><br><span class="line">router.post(<span class="string">&#x27;/friend&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> userKey = req.body.user_key;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`&quot;<span class="subst">$&#123;userKey&#125;</span>&quot;가 옐로아이디 친구 추가`</span>);</span><br><span class="line"></span><br><span class="line">  res.status(<span class="number">200</span>).json();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 사용자가 옐로아이디를 친구차단(삭제)했을때 호출되는 API</span></span><br><span class="line">router.delete(<span class="string">&#x27;/friend/:userKey&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> userKey = req.body.userKey;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`&quot;<span class="subst">$&#123;userKey&#125;</span>&quot;가 옐로아이디 친구 삭제`</span>);</span><br><span class="line"></span><br><span class="line">  res.status(<span class="number">200</span>).json();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 사용자가 채팅방 나가기(삭제)했을때 호출되는 API</span></span><br><span class="line">router.delete(<span class="string">&#x27;/chat_room/:userKey&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> userKey = req.body.user_key;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`&quot;<span class="subst">$&#123;userKey&#125;</span>&quot;가 옐로아이디 채팅방 삭제`</span>);</span><br><span class="line"></span><br><span class="line">  res.status(<span class="number">200</span>).json();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = router;</span><br></pre></td></tr></table></figure>

<p>작성한 router를 **<code>app.js</code>**에 추가합니다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> api = <span class="built_in">require</span>(<span class="string">&#x27;./routes/api&#x27;</span>);</span><br><span class="line">app.use(<span class="string">&#x27;/api&#x27;</span>, api);</span><br></pre></td></tr></table></figure>

<hr>
<span id="5">
## 서버 실행 & API 연동하기
서버는 해당 프로젝트 경로에서 **npm start** 혹은 **node bin/www** 로 실행할 수 있습니다. 그러나 해당 서버는 외부에서 접근 가능해야 합니다. 즉, AWS의 EC2와 같은 클라우드 자원을 사용하거나(추천), 본인의 컴퓨터 혹은 노트북에서 서버를 실행한다면 포트포워딩을 통해 **외부에서 접근할 수 있도록 설정이 필요합니다.**

<p>외부에서 접근할 수 있도록 설정이 끝난 후에는 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://yellowid.kakao.com/login">옐로아이디 홈페이지</a>에서 해당 서버의 URL을 기재합니다.</p>
<p><img src="/images/post/2017-05-17/yellowid_1.png" alt="옐로아이디 자동응답 API 등록-1"></p>
<p><img src="/images/post/2017-05-17/yellowid_2.png" alt="옐로아이디 자동응답 API 등록-2"></p>
<p>앱 URL을 기재하고 <strong>API TEST</strong> 버튼을 누르면 카카오에서 해당 URL에 test request를 요청합니다. test request의 결과를 통해 잘 작동하는지 확인이 가능합니다.</p>
<hr>
<span id="6">
## 마치며
이번 포스팅에서는 Express 프로젝트를 생성하고 API 문서를 토대로 간단한 봇을 만들어보았습니다. 해당 API를 토대로 앞으로 구현하고자 하는 기능을 구현하면 될것입니다.

<p>다음번에는 제가 Emily를 만들며 구현하고자 했던 부분들을 어떤식으로 해결했는지에 대해 포스팅하겠습니다.</p>
</span></span></span></span></span></span></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time datetime="2017-04-07T15:00:00.000Z" title="4/8/2017, 12:00:00 AM">2017-04-08</time>&nbsp;게시 됨</span><span class="level-item"><time datetime="2021-03-21T11:06:45.683Z" title="3/21/2021, 8:06:45 PM">2021-03-21</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/Programming/">Programming</a><span> / </span><a class="link-muted" href="/categories/Programming/Node/">Node</a></span><span class="level-item">16분안에 읽기 (약 2431 단어)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2017/04/08/Node/sequelize/">Sequelize 사용하기</a></h1><div class="content"><h2 id="Index"><a href="#Index" class="headerlink" title="Index"></a>Index</h2><ol>
<li><a href="#1">ORM 이란?</a></li>
<li><a href="#2">Sequelize 설치하기</a></li>
<li><a href="#3">Sequelize CLI 사용하기</a></li>
<li><a href="#4">Sequelize config 설정하기</a></li>
<li><a href="#5">Model 정의하기</a></li>
<li><a href="#6">Sequelize Sync 사용하기</a></li>
<li><a href="#7">Sequelize 예제 (SELECT)</a></li>
<li><a href="#8">Sequelize 예제 (INSERT)</a></li>
<li><a href="#9">Sequelize 예제 (UPDATE)</a></li>
<li><a href="#10">Sequelize 예제 (DELETE)</a></li>
</ol>
<hr>
<span id="1">
## ORM 이란?
**관계형 데이터베이스(RDB)**를 사용할때 데이터베이스의 데이터 조작(CRUD)를 위해서는 **SQL 문**을 작성해야합니다. SQL 문은 비즈니스 로직을 구성하고 있는 코드와 함께 작성하게 되는데 이는 코드의 가독성을 떨어뜨릴뿐만 아니라, 사용하는 관계형 데이터베이스에 따라 조금씩의 차이가 존재하기 때문에 문제가 발생할 수 있습니다. 이를 해결하기 위해 ORM을 사용합니다.

<p>**<code>ORM(Object Relational Mapping)</code>**은 객체(Object)와 관계(Relation)를 맵핑(Mapping)하여 <strong>비즈니스 로직에 집중</strong>할 수 있도록 데이터 처리 로직을 추상화시킵니다.</p>
<p>객체와 관계를 매핑한다는 것은 <strong>데이터베이스에 저장된 레코드를 객체로 바꿔표현한다는 의미</strong>하며, 비즈니스 로직에 집중할 수 있도록 데이터 처리 로직을 추상화한다는 것은 쿼리를 사용하지 않고도 데이터베이스를 사용할 수 있음을 뜻합니다.</p>
<p>ORM을 사용할 경우 특정 DBMS에 종속되지 않으며 생산성, 독립성, 가독성(SQL문이 코드에 들어가지 않기때문) 및 유지보수 측면에서의 장점이 있지만 반대로 RAW query에 비해 퍼포먼스가 떨어지고, query가 복잡해 질수록 오히려 생산성이 저하될 수 있다는 단점도 존재합니다.</p>
<p><img src="/images/post/2017-04-08/orm.png" alt="ORM"></p>
<hr>
<span id="2">
## Sequelize 설치하기
**[Sequelize](http://docs.sequelizejs.com/en/v3/)**는 Node에서 가장 많이 사용되는 ORM 입니다.

<p><strong>RDS로  PostgresSQL, MySQL, MariaDB, SQLite, MSSQL</strong>을 지원하고 transaction, read replication등 다양한 기능을 제공하고 있으며. 또한 <strong>Promise</strong>를 기본으로 동작하기 때문에 비동기 코드를 보기좋게 작성할 수 있습니다.</p>
<p>실습을 위해 express-generator를 통해 Express 프로젝트를 생성후 <code>sequelize</code>와 <code>mysql</code> module을 설치합니다. (Express 프로젝트를 생성하는 부분은 생략합니다.)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save sequelize mysql</span><br></pre></td></tr></table></figure>

<p>**<a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/sequelize/cli">Sequelize Command Line Interface(CLI)</a>**를 사용하기 위해서 <code>sequelize-cli</code> module을 설치합니다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g sequelize-cli</span><br></pre></td></tr></table></figure>

<hr>
<span id="3">
## Sequelize CLI 사용하기
**sequelize cli**를 통해서 **`migration(마이그레이션), seeder(시더), model(모델)`**의 초기 설정을 손쉽게 할 수 있습니다. 이번 포스팅에서는 **model**에 관해서 알아보겠습니다.

<p>RDB의 테이블을 model로 정의를 하면 해당 model을 통해 데이터 처리가 가능하게 됩니다.<br>먼저 생성한 express 프로젝트에 sequelize cli 명령어를 통해 sequelize 설정 파일을 생성 후 model을 정의해 보겠습니다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sequelize init:config --config config&#x2F;sequelize.json</span><br><span class="line">sequelize init:models</span><br></pre></td></tr></table></figure>

<p>sequelize cli의 <strong>sequelize init:config</strong>라는 명령어로 sequelize관련 config 파일을 자동으로 생성할 수 있습니다. 아무런 옵션을 주지 않는다면 <strong>config/config.json</strong> 파일이 생성됩니다.</p>
<p><strong>sequelize init:models</strong> 명령어를 통해서는 models 정의에 관련된 기본 구조를 생성할 수 있습니다.</p>
<p>위 2개의 명령어를 실행하면 다음과 같은 폴더와 파일이 생성됩니다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">├── config&#x2F;</span><br><span class="line">  └── sequelize.json</span><br><span class="line">├── models&#x2F;</span><br><span class="line">  └── index.js</span><br></pre></td></tr></table></figure>

<hr>
<span id="4">
## Sequelize config 설정하기
sequelize cli를 통해 생성한 `config/sequelize.json`파일에 데이터베이스에 관련된 설정 값을 입력합니다.

<p> <strong><code>NODE_ENV</code></strong> 에 따라 각기 다른 값을 사용하기 때문에 상황에 맞게 설정할 수 있습니다. NODE_ENV에 대해 잘 알지 못한다면 <a target="_blank" rel="external nofollow noopener noreferrer" href="http://inspiredjw.com/entry/Nodejs-%EC%97%90%EC%84%9C-NODEENV-%EA%B0%92%EC%9C%BC%EB%A1%9C-%ED%99%98%EA%B2%BD-%EC%84%A4%EC%A0%95%ED%95%98%EA%B8%B0">이곳</a>을 참고하세요.</p>
<p>데이터베이스를 사용한 프로젝트 경험이 있다면 대부분의 config 값은 입력할 수 있습니다. config 값중 <code>dialect</code>에는 사용하는 RDB 이름을 입력해야 합니다. diaect에 사용 가능한 값은 <a target="_blank" rel="external nofollow noopener noreferrer" href="http://docs.sequelizejs.com/en/1.7.0/docs/usage/">sequelize docs</a>를 참고하세요. 현재 사용 가능한 RDB 로는 ‘mysql’, ‘sqlite’, ‘postgress’, ‘mariadb’가 있습니다.</p>
<p>추가적으로 커넥션 풀과 로깅 기능을 사용한다면 해당 값을 추가합니다. 추가적으로 필요한 옵션은 docs를 참고하세요.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;pool&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;max&quot;</span>: <span class="number">20</span>,</span><br><span class="line">    <span class="string">&quot;min&quot;</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="string">&quot;idle&quot;</span>: <span class="number">5000</span></span><br><span class="line">&#125;,</span><br><span class="line"><span class="string">&quot;logging&quot;</span>: <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<hr>
<span id="5">
## # Model 정의하기
Model을 생성하기 전 sequelize cli를 통해 생성한 `models/index.js`파일을 살펴보겠습니다. index.js 의 역할은 **config/sequelize.json**의 설정값을 읽어 sequelize를 생성한 후 **models 폴더** 아래에 정의한 model 관련 js 파일을 모두 로딩하여 db 객체에 Model을 정의한 후 반환합니다.

<p>sequelize config 관련 파일을 sequelize.json으로 생성하였다면 config 파일을 불러오는 <strong>require 부분의 경로를 수정</strong>해주어야 합니다.</p>
<p>이제 models 폴더 아래에 간단한 모델을 정의해 보겠습니다. **<code>user.js</code>**를 생성 후 다음의 코드를 입력합니다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> (<span class="params">sequelize, DataTypes</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> user = sequelize.define(<span class="string">&#x27;User&#x27;</span>, &#123;</span><br><span class="line">    userID: &#123; <span class="attr">field</span>: <span class="string">&#x27;user_id&#x27;</span>, <span class="attr">type</span>: DataTypes.STRING(<span class="number">50</span>), <span class="attr">unique</span>: <span class="literal">true</span>, <span class="attr">allowNull</span>: <span class="literal">false</span> &#125;,</span><br><span class="line">    password: &#123; <span class="attr">field</span>: <span class="string">&#x27;password&#x27;</span>, <span class="attr">type</span>: DataTypes.STRING(<span class="number">30</span>), <span class="attr">allowNull</span>: <span class="literal">false</span> &#125;,</span><br><span class="line">  &#125;, &#123;</span><br><span class="line">    <span class="comment">// don&#x27;t use camelcase for automatically added attributes but underscore style</span></span><br><span class="line">    <span class="comment">// so updatedAt will be updated_at</span></span><br><span class="line">    underscored: <span class="literal">true</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// disable the modification of tablenames; By default, sequelize will automatically</span></span><br><span class="line">    <span class="comment">// transform all passed model names (first parameter of define) into plural.</span></span><br><span class="line">    <span class="comment">// if you don&#x27;t want that, set the following</span></span><br><span class="line">    freezeTableName: <span class="literal">true</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// define the table&#x27;s name</span></span><br><span class="line">    tableName: <span class="string">&#x27;user&#x27;</span></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> user;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> Sequelize 참고</span></span><br><span class="line"><span class="comment"> DataTypes =&gt; http://docs.sequelizejs.com/en/v3/api/datatypes/</span></span><br><span class="line"><span class="comment"> Associations =&gt; http://docs.sequelizejs.com/en/v3/api/associations/</span></span><br><span class="line"><span class="comment"> Model Function =&gt; http://docs.sequelizejs.com/en/v3/api/model/</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>

<p>Model을 생성하며 사용된 옵션은 주석과 docs를 참고합니다. 이제 모델에 대한 정의가 끝났습니다. 데이터베이스에 <strong>user</strong>라는 테이블은 <strong>User</strong>라는 Object로 매핑되었고 <strong>user_id, password</strong>라는 칼럼은 User Object의 속성으로 매핑되었습니다.</p>
<hr>
<span id="6">
## Sequelize Sync 사용하기
Sequeliz에서는 **입력(INSERT), 수정(UPDATE), 조회(SELECT), 삭제(DELETE)**의 **`데이터 조작(DML: Data Manipulation Language)`**뿐만 아니라 데이터베이스의 **스키마 객체를 생성(CREATE), 변경(ALERT), 제거(DROP)** 할 수 있는 **`데이터 정의(DDL: Data Definition Language)`**도 지원합니다.
따라서 이미 만들어진 데이터베이스 테이블에 모델을 매핑할 수 있을 뿐만 아니라, **정의한 모델을 바탕으로 테이블을 생성할 수도 있습니다.(동기화)**

<p>해당 기능을 사용하기 위해서는 Sequelize의 <strong><code>sync</code></strong> 메서드를 사용합니다. **<code>app.js</code>**에 다음의 코드를 추가합니다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// connect To DB</span></span><br><span class="line"><span class="keyword">const</span> models = <span class="built_in">require</span>(<span class="string">&#x27;./models&#x27;</span>);</span><br><span class="line">models.sequelize.sync()</span><br><span class="line">  .then(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;✓ DB connection success.&#x27;</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;  Press CTRL-C to stop\n&#x27;</span>);</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.error(err);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;✗ DB connection error. Please make sure DB is running.&#x27;</span>;</span><br><span class="line">    process.exit();</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>
<p>sync 메서드를 호출하여 실패했을 경우에는 에러 메시지를 출력 후 프로세스를 종료합니다.</p>
<p>sync 메서드는 모델에서 정의한 이름의 테이블이 존재하지 않을 경우에만 동작합니다. 이미 테이블이 존재할 경우에는 <strong><code>models.sequelize.sync(&#123;force: true&#125;)</code></strong> 과 같이 force 옵션을 주어 강제적으로 테이블을 제거 후 다시 생성이 가능하지만 매우 위험한 옵션이므로 주의를 기울여 사용해야 합니다.</p>
<hr>
<span id="7">
## Sequelize 예제 (SELECT)
이제 Sequelize를 사용하여 SELECT를 사용해보겠습니다. 유저 리스트를 가져오는 query는 다음과 같습니다.
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">models.User.findAll()</span><br><span class="line">  .then(results) &#123;</span><br><span class="line">     res.json(results);</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">     <span class="built_in">console</span>.error(err);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>
User 테이블에 있는 모든 row를 가져오는 query입니다. Sequelize는 결과를 Promise로 리턴하기 때문에 **`findAll`** 메서드 역시 Promise를 리턴합니다. 따라서 query의 결과는 then에서 받고, catch문에서 상황에 맞게 error 처리(handling)를 하면됩니다.

<p>findAll의 더 자세한 사용법은 <a target="_blank" rel="external nofollow noopener noreferrer" href="http://sequelize.readthedocs.io/en/latest/api/model/#findalloptions-promisearrayinstance">Sequelize-model-findAll 설명</a>을 참고합니다.</p>
<hr>
<span id="8">
## Sequelize 예제 (INSERT)
Sequelize를 사용하여 INSERT를 하는 방법은 다음과 같습니다.
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">models.User.create(&#123;<span class="attr">userID</span>: <span class="string">&#x27;유저ID&#x27;</span>, <span class="attr">password</span>: <span class="string">&#x27;유저PW&#x27;</span>&#125;)</span><br><span class="line">  .then(<span class="function"><span class="params">result</span> =&gt;</span> &#123;</span><br><span class="line">     res.json(result);</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">     <span class="built_in">console</span>.error(err);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>
**`create`** 메서드의 매개변수에 model에서 매핑한 내용을 토대로 데이터를 넣으면 query를 실행 후 insert된 row정보가 반환됩니다.

<p>create의 더 자세한 사용법은 <a target="_blank" rel="external nofollow noopener noreferrer" href="http://sequelize.readthedocs.io/en/latest/api/model/#createvalues-options-promiseinstance">Sequelize-model-create 설명</a>을 참고합니다.</p>
<hr>
<span id="9">
## Sequelize 예제 (UPDATE)
User 테이블의 데이터를 수정할때는 다음과 같이 사용합니다.
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">models.User.update(&#123;<span class="attr">password</span>: <span class="string">&#x27;새로운 유저PW&#x27;</span>&#125;, &#123;<span class="attr">where</span>: &#123;<span class="attr">userID</span>: <span class="string">&#x27;유저ID&#x27;</span>&#125;&#125;)</span><br><span class="line">  .then(<span class="function"><span class="params">result</span> =&gt;</span> &#123;</span><br><span class="line">     res.json(result);</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">     <span class="built_in">console</span>.error(err);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>
**`update`** 메서드의 매개변수에는 update할 데이터를 입력합니다.

<p>update 더 자세한 사용법은 <a target="_blank" rel="external nofollow noopener noreferrer" href="http://sequelize.readthedocs.io/en/latest/api/model/#updatevalues-options-promisearrayaffectedcount-affectedrows">Sequelize-model-update 설명</a>을 참고합니다.</p>
<hr>
<span id="10">
## Sequelize 예제 (DELETE)
User 테이블의 데이터를 삭제할때는 다음과 같이 사용합니다.
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">models.User.destroy(&#123;<span class="attr">where</span>: &#123;<span class="attr">userID</span>: <span class="string">&#x27;유저ID&#x27;</span>&#125;&#125;)</span><br><span class="line">  .then(<span class="function"><span class="params">result</span> =&gt;</span> &#123;</span><br><span class="line">     res.json(&#123;&#125;);</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">     <span class="built_in">console</span>.error(err);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>
**`destroy`** 메서드의 매개변수에는 where 조건을 입력합니다.**(where 조건을 입력하지 않을 경우 테이블의 모든 row가 삭제되기 때문에 주의해야 합니다.)**

<p>destroy 더 자세한 사용법은 <a target="_blank" rel="external nofollow noopener noreferrer" href="http://sequelize.readthedocs.io/en/latest/api/model/#destroyoptions-promiseinteger">Sequelize-model-update 설명</a>을 참고합니다.</p>
</span></span></span></span></span></span></span></span></span></span></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time datetime="2017-03-20T15:00:00.000Z" title="3/21/2017, 12:00:00 AM">2017-03-21</time>&nbsp;게시 됨</span><span class="level-item"><time datetime="2021-03-21T11:03:52.834Z" title="3/21/2021, 8:03:52 PM">2021-03-21</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/Project/">Project</a><span> / </span><a class="link-muted" href="/categories/Project/Emily/">Emily</a></span><span class="level-item">5분안에 읽기 (약 739 단어)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2017/03/21/Emily/2-make-kakao-yellow/">2) 카카오 옐로아이디 만들기</a></h1><div class="content"><h2 id="Index"><a href="#Index" class="headerlink" title="Index"></a>Index</h2><ol>
<li><a href="#1">옐로아이디란?</a></li>
<li><a href="#2">옐로아이디 만들기</a></li>
</ol>
<hr>
<span id="1">
## 옐로아이디란?
[옐로아이디](https://yellowid.kakao.com/login)란 `고객과 소통할 수 있는 카카오톡 비즈니스 아이디입니다.` 옐로아이디를 무료로 만들어 비즈니스에 활용가능하며 옐로아이디는 별도의 전화번호가 필요없고, 한글 아이디 검색이 가능합니다.

<p><img src="/images/post/2017-03-21/search_yellowid.jpeg" alt="옐로아이디 검색결과"></p>
<p>옐로아이디는 <strong><code>API형 자동응답</code>이 가능하기 때문에 사용자의 요청에 따라 자유롭게 답변 시나리오 및 이벤트를 구성할 수 있습니다.</strong></p>
<p>카카오 뿐만 아니라 <strong>페이스북, 텔레그램 또한 API형 자동응답 기능을 제공하기 때문에 굳이 옐로아이디를 사용하지 않아도 자동응답 챗봇을 만들 수 있습니다.</strong></p>
<hr>
<span id="2">
## 옐로아이디 만들기
옐로아이디를 사용하기위해서는 먼저 정해진 절차에 따라 가입신청을 해야합니다. [Yellow ID 신규가입](https://yellowid.kakao.com/join)을 통해 옐로아이디 신청이 가능합니다. 모바일이라면 [Yellow ID App](https://play.google.com/store/apps/details?id=com.kakao.yellowid) 설치 후 신청이 가능합니다.

<p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/plusfriend/auto_reply">옐로아이디 API 문서</a>는 공개되어 있기 때문에 옐로아이디 가입신청 후 기획이 되어있다며 바로 개발이 가능합니다. 가입신청이 완료되면 발급받은 API 키만 적용해주면 됩니다.</p>
<h4 id="신청시-주의사항"><a href="#신청시-주의사항" class="headerlink" title="신청시 주의사항"></a>신청시 주의사항</h4><ul>
<li><code>프로필 이름</code>과 <code>옐로아이디</code>는 <strong>개설 후 변경이 불가능합니다.</strong>(위의 사진에서 <strong>인천대학교 에밀리</strong>가 프로필 이름, <strong>@인천대학교-에밀리</strong>가 옐로아이디를 의미합니다.</li>
<li><code>주소</code>는 입력하지 않아도 상관없습니다.</li>
<li><code>홈페이지 주소</code>를 입력하게 되는데 저는 처음 블로그 주소를 기재하였다가 <strong>옐로아이디의 목적과 맞지 않다는 이유로 반려</strong>되었습니다. 옐로아이디에 대한 설명이 있는 홈페이지가 없다면 <strong>페이스북 페이지</strong>를 생성한 후 간단히 옐로아이디에 대한 목적과 서비스에 대해 간단한 글을 남긴 후 홈페이지 주소에 페이스북 페이지를 기재하는 방법이 좋습니다.</li>
<li><strong>심사는 2~3일 정도의 시간이 소요됩니다.</strong> 심사에서 반려될 경우 해당 반려사유를 참고하여 수정 후 재심사를 요청해야합니다. 재심사도 2~3일 정도의 시간이 소요되기 때문에 처음 신청시 반려되는 불상사가 일어나지 않도록 공들여 작성해야합니다.</li>
</ul>
</span></span></div></article></div><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous"><a href="/archives/16/">이전</a></div><div class="pagination-next"><a href="/archives/18/">다음</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link" href="/">1</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/archives/16/">16</a></li><li><a class="pagination-link is-current" href="/archives/17/">17</a></li><li><a class="pagination-link" href="/archives/18/">18</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/archives/21/">21</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/img/avatar.jpeg" alt="JongMin"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">JongMin</p><p class="is-size-6 is-block">생각을 기록하자</p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">포스트</p><a href="/archives"><p class="title">125</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">카테고리</p><a href="/categories"><p class="title">23</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">태그</p><a href="/tags"><p class="title">205</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/jongmin92" target="_blank" rel="external nofollow noopener noreferrer">팔로우</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="external nofollow noopener noreferrer" title="Github" href="https://github.com/jongmin92"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="external nofollow noopener noreferrer" title="Facebook" href="https://www.facebook.com/jongmin.kim.7796420"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">카테고리</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Algorithm/"><span class="level-start"><span class="level-item">Algorithm</span></span><span class="level-end"><span class="level-item tag">14</span></span></a><ul><li><a class="level is-mobile" href="/categories/Algorithm/BOJ/"><span class="level-start"><span class="level-item">BOJ</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/categories/Algorithm/Concept/"><span class="level-start"><span class="level-item">Concept</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Book/"><span class="level-start"><span class="level-item">Book</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Database/"><span class="level-start"><span class="level-item">Database</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Java/"><span class="level-start"><span class="level-item">Java</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Kotlin/"><span class="level-start"><span class="level-item">Kotlin</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Programming/"><span class="level-start"><span class="level-item">Programming</span></span><span class="level-end"><span class="level-item tag">95</span></span></a><ul><li><a class="level is-mobile" href="/categories/Programming/AWS/"><span class="level-start"><span class="level-item">AWS</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Programming/Git/"><span class="level-start"><span class="level-item">Git</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Programming/Gradle/"><span class="level-start"><span class="level-item">Gradle</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Programming/HTML/"><span class="level-start"><span class="level-item">HTML</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Programming/Java/"><span class="level-start"><span class="level-item">Java</span></span><span class="level-end"><span class="level-item tag">21</span></span></a></li><li><a class="level is-mobile" href="/categories/Programming/JavaScript/"><span class="level-start"><span class="level-item">JavaScript</span></span><span class="level-end"><span class="level-item tag">15</span></span></a></li><li><a class="level is-mobile" href="/categories/Programming/Linux-Ubuntu/"><span class="level-start"><span class="level-item">Linux &amp; Ubuntu</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/Programming/Node/"><span class="level-start"><span class="level-item">Node</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/Programming/RaspberryPi/"><span class="level-start"><span class="level-item">RaspberryPi</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/categories/Programming/React-Native/"><span class="level-start"><span class="level-item">React Native</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/Programming/Spring/"><span class="level-start"><span class="level-item">Spring</span></span><span class="level-end"><span class="level-item tag">19</span></span></a></li><li><a class="level is-mobile" href="/categories/Programming/Tool/"><span class="level-start"><span class="level-item">Tool</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Project/"><span class="level-start"><span class="level-item">Project</span></span><span class="level-end"><span class="level-item tag">6</span></span></a><ul><li><a class="level is-mobile" href="/categories/Project/Emily/"><span class="level-start"><span class="level-item">Emily</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Tip/"><span class="level-start"><span class="level-item">Tip</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></div></div></div><div class="column-right-shadow is-hidden-widescreen is-sticky"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3 is-sticky"><!--!--><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">최근 글</h3><article class="media"><div class="media-content"><p class="date"><time datetime="2021-03-20T15:17:42.000Z">2021-03-21</time></p><p class="title"><a href="/2021/03/21/Kotlin/coroutines/">코루틴 이해하기</a></p><p class="categories"><a href="/categories/Kotlin/">Kotlin</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2020-03-30T15:44:27.000Z">2020-03-31</time></p><p class="title"><a href="/2020/03/31/Java/use-assertthat/">Unit Test에서 AssertThat을 사용하자</a></p><p class="categories"><a href="/categories/Java/">Java</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2020-01-02T13:29:00.000Z">2020-01-02</time></p><p class="title"><a href="/2020/01/02/Java/rsa/">Encryption - RSA</a></p><p class="categories"><a href="/categories/Programming/">Programming</a> / <a href="/categories/Programming/Java/">Java</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2019-12-26T13:23:00.000Z">2019-12-26</time></p><p class="title"><a href="/2019/12/26/Programming/2019-retrospect/">2년차 LINE 서버 개발자의 2019년 회고</a></p><p class="categories"><a href="/categories/Programming/">Programming</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2019-12-23T14:37:00.000Z">2019-12-23</time></p><p class="title"><a href="/2019/12/23/Programming/hmac/">HMAC을 이용한 무결성 보장</a></p><p class="categories"><a href="/categories/Programming/">Programming</a></p></div></article></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.png" alt="92Hz" height="28"></a><p class="is-size-7"><span>&copy; 2021 KimJongMin</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="external nofollow noopener noreferrer">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="external nofollow noopener noreferrer">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="external nofollow noopener noreferrer" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="external nofollow noopener noreferrer" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="external nofollow noopener noreferrer" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("ko");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="맨 위로" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="입력 하세요..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"입력 하세요...","untitled":"(제목 없음)","posts":"포스트","pages":"페이지","categories":"카테고리","tags":"태그"});
        });</script></body></html>